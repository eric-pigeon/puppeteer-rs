{{autoGeneratedComment}}
use serde;
use serde::{Deserialize, Serialize};

{{#each domains}}
pub mod {{underscore domain}};
{{/each}}

pub(crate) trait Command {
    const NAME: &'static str;

    type ReturnObject: serde::de::DeserializeOwned;

    fn to_command_call(self, call_id: u64) -> CommandCall<Self>
    where
        Self: std::marker::Sized,
    {
        CommandCall {
            id: call_id,
            params: self,
            method: Self::NAME,
        }
    }
}

#[derive(Serialize, Debug)]
pub struct CommandCall<T> {
    method: &'static str,
    pub id: u64,
    params: T,
}

#[derive(Deserialize, Debug, Clone, PartialEq)]
#[serde(tag = "method")]
pub enum Event {
}

#[derive(Deserialize, Debug, PartialEq, Clone)]
pub struct RemoteError {
    pub code: u64,
    pub message: String,
}

#[derive(Deserialize, Debug, PartialEq, Clone)]
pub struct Response {
    #[serde(rename(deserialize = "id"))]
    pub call_id: u64,
    pub result: Option<serde_json::Value>,
    pub error: Option<RemoteError>,
}

#[derive(Deserialize, Debug, Clone)]
#[serde(untagged)]
pub enum Message {
    Event(Event),
    Response(Response),
    ConnectionShutdown,
}
